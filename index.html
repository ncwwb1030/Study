<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INFS5720 Revision App</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f0f2f5; }
        .app-gradient { background: linear-gradient(135deg, #1e3a8a, #3b82f6); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        [v-cloak] { display: none; }
    </style>
</head>
<body>

<div id="app" v-cloak class="min-h-screen flex flex-col bg-gray-50">

    <header class="app-gradient text-white pb-24 pt-10 px-6 rounded-b-[2.5rem] shadow-xl relative z-10">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-3xl font-extrabold">INFS5720</h1>
                <p class="text-blue-100 text-sm mt-1">Exam Prep</p>
            </div>
            <button @click="resetApp" class="text-xs bg-red-500/80 px-3 py-1 rounded text-white">Reset</button>
        </div>

        <nav class="flex justify-between px-2">
            <button v-for="tab in tabs" :key="tab.id" @click="currentTab = tab.id"
                class="flex flex-col items-center opacity-70 transition-all"
                :class="{'opacity-100 scale-110': currentTab === tab.id}">
                <div class="w-12 h-12 rounded-2xl flex items-center justify-center text-xl bg-white/10 border-2 border-white/20"
                     :class="{'bg-white text-blue-600 border-white': currentTab === tab.id}">
                    <i :class="tab.icon"></i>
                </div>
                <span class="text-[10px] font-bold mt-2 uppercase">{{ tab.name }}</span>
            </button>
        </nav>
    </header>

    <main class="flex-1 -mt-16 px-4 pb-10 z-20 overflow-y-auto">
        
        <div v-if="currentTab === 'outline'" class="bg-white rounded-3xl shadow p-6">
            <h2 class="text-lg font-bold text-gray-800 mb-4">Course Blueprint</h2>
            <div v-for="(item, idx) in outlineData" :key="idx" class="mb-4 border-l-4 pl-3" :class="item.color">
                <span class="text-xs font-bold text-gray-400 uppercase">{{ item.category }}</span>
                <h3 class="font-bold text-gray-800">{{ item.topic }}</h3>
                <p class="text-sm text-gray-500">{{ item.details }}</p>
            </div>
        </div>

        <div v-if="currentTab === 'notes'" class="space-y-4">
            <div v-for="(note, index) in notesData" :key="index" class="bg-white rounded-2xl shadow overflow-hidden">
                <div @click="toggleNote(index)" class="p-5 flex justify-between items-center cursor-pointer">
                    <div class="font-bold text-gray-800">{{ note.id }}: {{ note.title }}</div>
                    <i class="fas fa-chevron-down text-gray-400" :class="{'rotate-180': note.isOpen}"></i>
                </div>
                <div v-if="note.isOpen" class="px-5 pb-5 bg-gray-50 text-sm text-gray-600 border-t">
                    <ul class="list-disc ml-4 mt-2 space-y-2">
                        <li v-for="p in note.points" v-html="p"></li>
                    </ul>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'bank'" class="space-y-4">
            <div class="flex gap-2 overflow-x-auto pb-2">
                <button v-for="filter in ['All', 'Practice', ...lecturesList]" :key="filter"
                    @click="bankFilter = filter"
                    class="px-3 py-1 rounded-full text-xs font-bold border whitespace-nowrap"
                    :class="bankFilter === filter ? 'bg-blue-600 text-white' : 'bg-white text-gray-500'">
                    {{ filter }}
                </button>
            </div>

            <div v-for="(q, idx) in filteredQuestions" :key="idx" class="bg-white rounded-2xl shadow p-5">
                <span class="text-[10px] font-bold px-2 py-1 rounded text-white mb-2 inline-block" :class="q.source === 'Practice' ? 'bg-green-500' : 'bg-blue-500'">{{ q.category }}</span>
                <p class="font-bold text-gray-800 text-sm mb-4">{{ q.question }}</p>
                
                <div class="space-y-2">
                    <button v-for="opt in q.options" 
                        @click="checkBankAnswer(q, opt)"
                        class="w-full text-left text-xs px-4 py-3 rounded-lg border"
                        :class="getBankClass(q, opt)">
                        {{ opt }}
                    </button>
                </div>
                <div v-if="q.userSelected" class="mt-3 p-3 bg-gray-50 rounded text-xs">
                    <strong>Correct:</strong> {{ q.answer }} <br>
                    <span class="text-gray-500">{{ q.explanation }}</span>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'mistakes'" class="space-y-4">
            <div v-if="mistakes.length === 0" class="bg-white rounded-3xl p-8 text-center shadow">
                <h2 class="text-xl font-bold text-green-500">No Mistakes!</h2>
            </div>
            <div v-else v-for="(q, idx) in mistakes" :key="idx" class="bg-white rounded-2xl shadow border-l-4 border-red-400 p-5">
                <span class="text-xs font-bold text-red-400">Review</span>
                <p class="font-bold text-gray-800 text-sm my-2">{{ q.question }}</p>
                <div class="space-y-2">
                    <button v-for="opt in q.options" @click="solveMistake(idx, opt, q.answer)" class="w-full text-left text-xs p-2 border rounded hover:bg-gray-100">{{ opt }}</button>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'quiz'" class="bg-white rounded-3xl shadow p-6 min-h-[400px] flex flex-col justify-center text-center">
            <div v-if="quizState === 'start'">
                <h2 class="text-2xl font-bold text-blue-600 mb-2">AI Quiz</h2>
                <p class="text-gray-500 text-xs mb-6">10 Random Questions</p>
                <button @click="startQuiz" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl shadow">Start</button>
            </div>
            
            <div v-if="quizState === 'playing'" class="text-left">
                <div class="flex justify-between mb-4 text-xs font-bold text-gray-500">
                    <span>Q {{ currentQuestionIndex + 1 }}/10</span>
                    <span>Score: {{ score }}</span>
                </div>
                <p class="font-bold text-gray-800 mb-4">{{ currentQuizQuestion.question }}</p>
                <div class="space-y-2">
                    <button v-for="opt in currentQuizQuestion.options" @click="checkQuizAnswer(opt)" :disabled="hasAnswered"
                        class="w-full text-left text-xs p-3 rounded border" :class="getQuizClass(opt)">{{ opt }}</button>
                </div>
                <button v-if="hasAnswered" @click="nextQuestion" class="w-full mt-4 bg-gray-800 text-white py-3 rounded font-bold">Next</button>
            </div>

            <div v-if="quizState === 'result'">
                <h2 class="text-3xl font-bold text-blue-600 mb-2">{{ score }}/10</h2>
                <button @click="startQuiz" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl shadow mt-4">New Quiz</button>
            </div>
        </div>

    </main>
</div>

<script>
    const app = Vue.createApp({
        data() {
            return {
                currentTab: 'outline',
                tabs: [
                    { id: 'outline', name: 'Outline', icon: 'fas fa-list-ul' },
                    { id: 'notes', name: 'Notes', icon: 'fas fa-book-open' },
                    { id: 'bank', name: 'Bank', icon: 'fas fa-layer-group' },
                    { id: 'mistakes', name: 'Mistakes', icon: 'fas fa-exclamation-triangle' },
                    { id: 'quiz', name: 'Quiz', icon: 'fas fa-robot' }
                ],
                bankFilter: 'All',
                lecturesList: ["L1 Intro", "L2 Cluster", "L3 Reg", "L3 Logistic", "L4 Method", "L4 Reg", "L5 Tree", "L7 ANN", "L8 Ensemble", "L9 MAB", "L10 CNN"],
                mistakes: JSON.parse(localStorage.getItem('infs_mistakes_v2') || '[]'),
                
                // Outline Data
                outlineData: [
                    { category: "Overview", topic: "Model Landscape", details: "Supervised vs Unsupervised vs RL.", color: "border-blue-500" },
                    { category: "Regression", topic: "Linear & Regularization", details: "MSE, R², Lasso vs Ridge.", color: "border-green-500" },
                    { category: "Classify", topic: "Logit & Trees", details: "Logit, Gini, Entropy, Pruning.", color: "border-purple-500" },
                    { category: "Deep ML", topic: "ANN & CNN", details: "Backprop, Activation, Filters.", color: "border-orange-500" }
                ],

                // Notes Data
                notesData: [
                    { id: "L1", title: "Intro & ML Types", isOpen: false, points: ["<b>Supervised:</b> Has Target Y.", "<b>Unsupervised:</b> No Target.", "<b>RL:</b> Rewards (MAB)."] },
                    { id: "L2", title: "Clustering & PCA", isOpen: false, points: ["<b>K-Means:</b> Random centroids.", "<b>Hierarchical:</b> Dendrogram.", "<b>PCA:</b> Dim reduction. PC1 max variance."] },
                    { id: "L3", title: "Regression", isOpen: false, points: ["<b>Linear:</b> R² explains variance.", "<b>Logistic:</b> Sigmoid. Logit = log(p/1-p).", "<b>Odds Ratio:</b> exp(beta)."] },
                    { id: "L4", title: "Regularization", isOpen: false, points: ["<b>Bias-Variance:</b> Simple=Bias, Complex=Variance.", "<b>Lasso (L1):</b> Feature selection.", "<b>Ridge (L2):</b> Shrinks coeff."] },
                    { id: "L5", title: "Decision Trees", isOpen: false, points: ["<b>Splitting:</b> Gini/Entropy.", "<b>Pruning:</b> Stop overfitting.", "<b>C4.5:</b> Info Gain Ratio."] },
                    { id: "L7", title: "Neural Networks", isOpen: false, points: ["<b>Activation:</b> ReLU/Sigmoid.", "<b>Backprop:</b> Update weights via gradient."] },
                    { id: "L8", title: "Ensemble", isOpen: false, points: ["<b>Bagging:</b> Parallel (RF). Reduces Variance.", "<b>Boosting:</b> Sequential (AdaBoost). Reduces Bias."] },
                    { id: "L9", title: "MAB (RL)", isOpen: false, points: ["<b>Exploration:</b> Try new.", "<b>Exploitation:</b> Use best.", "<b>Thompson:</b> Bayesian (Beta dist)."] },
                    { id: "L10", title: "CNN", isOpen: false, points: ["<b>Conv:</b> Extract features.", "<b>Pooling:</b> Downsample."] }
                ],

                // Question Bank
                rawQuestions: [
                    { src: "Practice", cat: "General", q: "Which describes underfitting?", a: "Low variance and high bias", opts: ["High variance and high bias", "High variance and low bias", "Low variance and high bias", "Low variance and low bias"] },
                    { src: "Practice", cat: "L4 Reg", q: "Ridge regularization helps by?", a: "Increasing bias a bit and reduce variance", opts: ["Reduce bias and variance", "Increase bias a bit and reduce variance", "Reduce bias and increase variance"] },
                    { src: "Practice", cat: "L3 Logistic", q: "Logistic Regression used for?", a: "Binary classification problems", opts: ["Regression", "MAB", "Binary classification problems", "Clustering"] },
                    { src: "Kahoot", cat: "L1 Intro", q: "Market segmentation is Supervised Learning?", a: "False", opts: ["True", "False"], explanation: "It is Unsupervised." },
                    { src: "Kahoot", cat: "L2 Cluster", q: "K-Means guarantees finding global optimum?", a: "False", opts: ["True", "False"], explanation: "Sensitive to initialization." },
                    { src: "Kahoot", cat: "L8 Ensemble", q: "Bagging uses?", a: "Bootstrap samples", opts: ["Sequential training", "Bootstrap samples", "Gradient descent"] },
                    { src: "Kahoot", cat: "L10 CNN", q: "Pooling is for?", a: "Dimensionality reduction", opts: ["Feature extraction", "Activation", "Dimensionality reduction"] }
                ],
                questionBank: [], // Populated in created()

                // Quiz State
                quizState: 'start',
                quizQuestions: [],
                currentQuestionIndex: 0,
                score: 0,
                hasAnswered: false,
                currentQuizQuestion: {}
            }
        },
        computed: {
            filteredQuestions() {
                if (this.bankFilter === 'All') return this.questionBank;
                if (this.bankFilter === 'Practice') return this.questionBank.filter(q => q.source === 'Practice');
                return this.questionBank.filter(q => q.category === this.bankFilter);
            }
        },
        created() {
            // Init Question Bank with user selection state
            this.questionBank = this.rawQuestions.map(q => ({
                ...q,
                options: q.opts,
                userSelected: null
            }));
        },
        watch: {
            mistakes: {
                handler(val) { localStorage.setItem('infs_mistakes_v2', JSON.stringify(val)); },
                deep: true
            }
        },
        methods: {
            resetApp() {
                localStorage.clear();
                window.location.reload();
            },
            toggleNote(index) {
                this.notesData[index].isOpen = !this.notesData[index].isOpen;
            },
            // Bank Logic
            checkBankAnswer(q, opt) {
                q.userSelected = opt;
                if(opt !== q.answer) {
                    // Add to mistakes (deep copy)
                    const m = JSON.parse(JSON.stringify(q));
                    m.userSelected = null; // Reset selection for mistake review
                    if(!this.mistakes.find(x => x.question === m.question)) {
                        this.mistakes.push(m);
                    }
                }
            },
            getBankClass(q, opt) {
                if(!q.userSelected) return 'border-gray-200';
                if(opt === q.answer) return 'bg-green-100 border-green-500 text-green-700 font-bold';
                if(opt === q.userSelected) return 'bg-red-100 border-red-500 text-red-700';
                return 'opacity-50';
            },
            // Mistakes Logic
            solveMistake(idx, opt, ans) {
                if(opt === ans) {
                    alert("Correct! Removed from list.");
                    this.mistakes.splice(idx, 1);
                } else {
                    alert("Try again!");
                }
            },
            // Quiz Logic
            startQuiz() {
                // Simple random generator for demo (Expandable)
                this.quizQuestions = this.rawQuestions
                    .sort(() => 0.5 - Math.random())
                    .slice(0, 10)
                    .map(q => ({...q, options: q.opts.sort(() => 0.5 - Math.random())}));
                
                this.currentQuestionIndex = 0;
                this.score = 0;
                this.hasAnswered = false;
                this.currentQuizQuestion = this.quizQuestions[0];
                this.quizState = 'playing';
            },
            checkQuizAnswer(opt) {
                this.hasAnswered = true;
                if(opt === this.currentQuizQuestion.answer) {
                    this.score++;
                } else {
                    // Add to mistakes
                    const m = JSON.parse(JSON.stringify(this.currentQuizQuestion));
                    m.userSelected = null;
                    if(!this.mistakes.find(x => x.question === m.question)) this.mistakes.push(m);
                }
            },
            getQuizClass(opt) {
                if(!this.hasAnswered) return 'border-gray-200 hover:bg-blue-50';
                if(opt === this.currentQuizQuestion.answer) return 'bg-green-100 border-green-500 font-bold';
                return 'opacity-50';
            },
            nextQuestion() {
                if (this.currentQuestionIndex < 9) {
                    this.currentQuestionIndex++;
                    this.currentQuizQuestion = this.quizQuestions[this.currentQuestionIndex];
                    this.hasAnswered = false;
                } else {
                    this.quizState = 'result';
                }
            }
        }
    }).mount('#app');
</script>

</body>
</html>
