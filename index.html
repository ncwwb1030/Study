<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>INFS5720 Final Revision</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .app-gradient { background: linear-gradient(135deg, #2563eb, #7c3aed); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        [v-cloak] { display: none; }
    </style>
</head>
<body>

<div id="app" v-cloak class="min-h-screen flex flex-col bg-gray-50">

    <header class="app-gradient text-white pb-20 pt-8 px-6 rounded-b-[2.5rem] shadow-lg relative z-10">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-3xl font-extrabold">INFS5720</h1>
                <p class="text-blue-100 text-xs">Revision Master</p>
            </div>
            <button @click="resetApp" class="bg-white/20 px-3 py-1 rounded text-xs">Reset Data</button>
        </div>
        <nav class="flex justify-between px-2">
            <button v-for="tab in tabs" :key="tab.id" @click="currentTab = tab.id"
                class="flex flex-col items-center opacity-70 transition-all"
                :class="{'opacity-100 scale-110': currentTab === tab.id}">
                <div class="w-12 h-12 rounded-2xl flex items-center justify-center text-xl bg-white/10 border border-white/20"
                     :class="{'bg-white text-blue-600': currentTab === tab.id}">
                    <i :class="tab.icon"></i>
                </div>
                <span class="text-[10px] font-bold mt-2 uppercase">{{ tab.name }}</span>
            </button>
        </nav>
    </header>

    <main class="flex-1 -mt-12 px-4 pb-10 z-20 overflow-y-auto">
        
        <div v-if="currentTab === 'outline'" class="bg-white rounded-3xl shadow p-6 mb-20">
            <h2 class="text-lg font-bold text-gray-800 mb-4 border-l-4 border-blue-500 pl-3">Course Structure</h2>
            <div v-for="item in outlineData" :key="item.category" class="mb-4">
                <span class="text-xs font-bold text-blue-600 uppercase">{{ item.category }}</span>
                <h3 class="font-bold text-gray-800">{{ item.topic }}</h3>
                <p class="text-xs text-gray-500">{{ item.details }}</p>
            </div>
        </div>

        <div v-if="currentTab === 'notes'" class="space-y-4 mb-20">
            <div v-for="(note, idx) in notesData" :key="idx" class="bg-white rounded-2xl shadow overflow-hidden">
                <div @click="note.isOpen = !note.isOpen" class="p-4 flex justify-between items-center cursor-pointer bg-white">
                    <span class="font-bold text-gray-800 text-sm">{{ note.id }}: {{ note.title }}</span>
                    <i class="fas fa-chevron-down text-gray-400" :class="{'rotate-180': note.isOpen}"></i>
                </div>
                <div v-if="note.isOpen" class="px-4 pb-4 bg-gray-50 text-sm text-gray-600 border-t">
                    <ul class="list-disc ml-4 mt-2 space-y-2">
                        <li v-for="p in note.points" v-html="p"></li>
                    </ul>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'bank'" class="space-y-4 mb-20">
            <div class="flex gap-2 overflow-x-auto pb-2">
                <button v-for="filter in ['All', 'Practice', 'L1', 'L2', 'L3', 'L4', 'L5', 'L7', 'L8', 'L9', 'L10']" 
                    @click="bankFilter = filter"
                    class="px-3 py-1 rounded-full text-xs font-bold border whitespace-nowrap transition-colors"
                    :class="bankFilter === filter ? 'bg-blue-600 text-white' : 'bg-white text-gray-500'">
                    {{ filter }}
                </button>
            </div>

            <div v-for="(q, idx) in filteredQuestions" :key="idx" class="bg-white rounded-2xl shadow p-5">
                <div class="flex justify-between mb-2">
                    <span class="text-[10px] font-bold px-2 py-1 rounded text-white" 
                          :class="q.source === 'Practice' ? 'bg-green-500' : 'bg-blue-500'">
                        {{ q.category }}
                    </span>
                </div>
                <p class="font-bold text-gray-800 text-sm mb-3">{{ q.question }}</p>
                
                <div class="space-y-2">
                    <button v-for="opt in q.options" 
                        @click="checkBankAnswer(q, opt)"
                        class="w-full text-left text-xs px-4 py-3 rounded-lg border transition-colors"
                        :class="getBankClass(q, opt)">
                        {{ opt }}
                    </button>
                </div>
                
                <div v-if="q.userSelected" class="mt-3 p-3 bg-gray-50 rounded border text-xs">
                    <strong>Correct:</strong> {{ q.answer }}
                    <div v-if="q.explanation" class="text-gray-500 mt-1">{{ q.explanation }}</div>
                </div>
            </div>
            <div v-if="filteredQuestions.length === 0" class="text-center py-10 text-gray-400 text-sm">No questions found.</div>
        </div>

        <div v-if="currentTab === 'mistakes'" class="space-y-4 mb-20">
            <div v-if="mistakes.length === 0" class="bg-white rounded-2xl p-8 text-center shadow">
                <h2 class="text-xl font-bold text-green-500">Clean Sheet!</h2>
                <p class="text-xs text-gray-400">No mistakes yet.</p>
            </div>
            <div v-else v-for="(q, idx) in mistakes" :key="idx" class="bg-white rounded-2xl shadow border-l-4 border-red-500 p-5">
                <span class="text-[10px] font-bold text-gray-400 uppercase">{{ q.category }}</span>
                <p class="font-bold text-gray-800 text-sm my-2">{{ q.question }}</p>
                <div class="space-y-2">
                    <button v-for="opt in q.options" @click="solveMistake(idx, opt, q.answer)" 
                        class="w-full text-left text-xs p-3 border rounded hover:bg-gray-50">
                        {{ opt }}
                    </button>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'quiz'" class="bg-white rounded-3xl shadow p-6 min-h-[400px] flex flex-col justify-center text-center">
            <div v-if="quizState === 'start'">
                <div class="text-5xl mb-4">ðŸ¤–</div>
                <h2 class="text-2xl font-bold text-gray-800 mb-2">AI Quiz</h2>
                <p class="text-gray-500 text-xs mb-6">10 Random Questions</p>
                <button @click="startQuiz" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl shadow">Start</button>
            </div>
            
            <div v-if="quizState === 'playing'" class="text-left">
                <div class="flex justify-between mb-4 text-xs font-bold text-gray-500">
                    <span>Q {{ currentQuestionIndex + 1 }}/10</span>
                    <span>Score: {{ score }}</span>
                </div>
                <p class="font-bold text-gray-800 mb-4 text-sm">{{ currentQuizQuestion.question }}</p>
                <div class="space-y-2">
                    <button v-for="opt in currentQuizQuestion.options" 
                        @click="checkQuizAnswer(opt)" :disabled="hasAnswered"
                        class="w-full text-left text-xs p-3 rounded border transition-colors" 
                        :class="getQuizClass(opt)">
                        {{ opt }}
                    </button>
                </div>
                <div v-if="hasAnswered" class="mt-4">
                     <p v-if="!isCorrect" class="text-xs text-red-500 font-bold mb-2">Wrong! Correct: {{ currentQuizQuestion.answer }}</p>
                     <button @click="nextQuestion" class="w-full bg-gray-800 text-white py-3 rounded-xl font-bold text-xs">Next</button>
                </div>
            </div>

            <div v-if="quizState === 'result'">
                <h2 class="text-3xl font-bold text-blue-600 mb-2">{{ score }}/10</h2>
                <p class="text-xs text-gray-500 mb-6">Quiz Complete</p>
                <button @click="startQuiz" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl shadow">New Quiz</button>
            </div>
        </div>

    </main>
</div>

<script>
    const app = Vue.createApp({
        data() {
            return {
                currentTab: 'bank', // Default to Bank to verify visibility
                tabs: [
                    { id: 'outline', name: 'Outline', icon: 'fas fa-list' },
                    { id: 'notes', name: 'Notes', icon: 'fas fa-book' },
                    { id: 'bank', name: 'Bank', icon: 'fas fa-layer-group' },
                    { id: 'mistakes', name: 'Mistakes', icon: 'fas fa-exclamation-triangle' },
                    { id: 'quiz', name: 'AI Quiz', icon: 'fas fa-robot' }
                ],
                bankFilter: 'All',
                mistakes: JSON.parse(localStorage.getItem('infs_mistakes_v4') || '[]'),
                
                // DATA: Outline
                outlineData: [
                    { category: "Overview", topic: "Model Landscape", details: "Supervised vs Unsupervised vs RL." },
                    { category: "Regression", topic: "Linear & Regularization", details: "MSE, RMSE, RÂ². Lasso vs Ridge." },
                    { category: "Classify", topic: "Logit & Trees", details: "Odds Ratio, Gini, Entropy, Pruning." },
                    { category: "Deep ML", topic: "ANN & CNN", details: "Backprop, Activation, Filters." }
                ],

                // DATA: Notes
                notesData: [
                    { id: "L1", title: "Intro & ML Types", isOpen: false, points: ["<b>Supervised:</b> Target Y (Reg/Class).", "<b>Unsupervised:</b> No Target.", "<b>RL:</b> Rewards (MAB)."] },
                    { id: "L2", title: "Clustering & PCA", isOpen: false, points: ["<b>K-Means:</b> Random centroids.", "<b>PCA:</b> PC1 max variance."] },
                    { id: "L3", title: "Regression", isOpen: false, points: ["<b>Linear:</b> RÂ² explains variance.", "<b>Logistic:</b> Logit = log(p/1-p)."] },
                    { id: "L4", title: "Regularization", isOpen: false, points: ["<b>Bias-Variance:</b> Simple=Bias, Complex=Variance.", "<b>Lasso:</b> Feature selection."] },
                    { id: "L5", title: "Trees", isOpen: false, points: ["<b>Splitting:</b> Gini/Entropy.", "<b>Pruning:</b> Stop overfitting."] },
                    { id: "L7", title: "ANN", isOpen: false, points: ["<b>Activation:</b> ReLU/Sigmoid.", "<b>Backprop:</b> Update weights."] },
                    { id: "L8", title: "Ensemble", isOpen: false, points: ["<b>Bagging:</b> RF (Variance).", "<b>Boosting:</b> AdaBoost (Bias)."] },
                    { id: "L9", title: "MAB", isOpen: false, points: ["<b>Explore vs Exploit:</b> E-Greedy, Thompson."] },
                    { id: "L10", title: "CNN", isOpen: false, points: ["<b>Conv:</b> Features.", "<b>Pool:</b> Downsample."] }
                ],

                // DATA: Question Bank (FULL)
                allQuestions: [
                    { src: "Practice", cat: "General", q: "Which describes underfitting?", a: "Low variance and high bias", opts: ["High variance and high bias", "High variance and low bias", "Low variance and high bias", "Low variance and low bias"] },
                    { src: "Practice", cat: "L4", q: "Ridge regularization helps by?", a: "Increasing bias a bit and reduce variance", opts: ["Reducing bias and variance", "Increasing bias a bit and reduce variance", "Reducing bias only", "Increasing variance only"] },
                    { src: "Practice", cat: "L4", q: "Training set's RÂ² with complexity?", a: "It always goes up", opts: ["Goes down then up", "Goes up then down", "Always goes down", "Always goes up"] },
                    { src: "Practice", cat: "L4", q: "Purpose of validation set?", a: "Prevents overfitting and helps in hyperparameter tuning", opts: ["Helps memorize data", "Prevents overfitting and helps in hyperparameter tuning", "Testing final model", "Increases training size"] },
                    { src: "Practice", cat: "L3", q: "Target y is binary (30% 0, 70% 1). Predict all 1. Training accuracy?", a: "70%", opts: ["30%", "70%", "50%", "Depends"] },
                    { src: "Practice", cat: "L3", q: "Logistic Regression used for?", a: "Binary classification problems", opts: ["Regression", "MAB", "Binary classification problems", "Clustering"] },
                    { src: "Practice", cat: "L5", q: "C5.0 prevents favoritism via?", a: "Information gain ratio", opts: ["Random noise", "Equal chance", "Information gain ratio", "Favors binary inputs"] },
                    { src: "Practice", cat: "L7", q: "FALSE about neural networks?", a: "Highly interpretable", opts: ["Highly interpretable", "Require large labelled data", "Computationally heavy", "Prone to overfitting"] },
                    { src: "Practice", cat: "L8", q: "TRUE about AdaBoost?", a: "Adapts to mistakes of previous models", opts: ["Equal weight", "Less sensitive to noise", "Single complex model", "Adapts to mistakes of previous models"] },
                    { src: "Practice", cat: "L9", q: "TRUE about exploration-exploitation?", a: "Balancing helps discover best arm over time", opts: ["Balancing helps discover best arm over time", "Max exploration best", "Exploitation random", "Exploration immediate"] },
                    
                    { src: "Kahoot", cat: "L1", q: "Tick all AI options.", a: "Self-driving car", opts: ["Calculator", "Computer", "Self-driving car", "Laundry Machine"] },
                    { src: "Kahoot", cat: "L1", q: "Market segmentation is Supervised?", a: "False", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L1", q: "Series is 2D with 2 columns?", a: "False", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L1", q: "One column from DataFrame is Series?", a: "True", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L1", q: "Example of Topic Model?", a: "Find topics from updates", opts: ["Label updates +/-", "Find topics from updates"] },
                    { src: "Kahoot", cat: "L1", q: "Doc-term matrix is sparse?", a: "True", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L1", q: "Why truncate SVD?", a: "Keep only top-ranked topics", opts: ["Find all topics", "Keep only top-ranked topics"] },
                    { src: "Kahoot", cat: "L1", q: "GPT stands for?", a: "Generative Pre-trained Transformer", opts: ["Guide", "Generative Pre-trained Transformer"] },

                    { src: "Kahoot", cat: "L2", q: "FALSE about clustering?", a: "Two clusters can have common observations", opts: ["Subset", "Union is entire set", "Two clusters can have common observations", "Within cluster similar"] },
                    { src: "Kahoot", cat: "L2", q: "Segmentation by Age/Gender is clustering?", a: "False", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L2", q: "FALSE about Euclidean?", a: "No variable can dominate", opts: ["No variable can dominate", "Sqrt sum squared", "Scaling needed", "Categorical overshadow"] },
                    { src: "Kahoot", cat: "L2", q: "Complete linkage measures minimum?", a: "False", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L2", q: "FALSE about Agglomerative?", a: "Final outcome is one cluster regardless of threshold", opts: ["Merges hierarchically", "Expensive", "Various linkages", "Final outcome is one cluster regardless of threshold"] },
                    { src: "Kahoot", cat: "L2", q: "FALSE about K-Means?", a: "If start with K=3, might end with 2 clusters", opts: ["We start with randomly selected K centroids", "Assign nearest", "If start with K=3, might end with 2 clusters", "Stop when no change"] },
                    { src: "Kahoot", cat: "L2", q: "Silhouette Score NOT about?", a: "Whether each observation is in right cluster", opts: ["Cohesion", "Separation", "Whether each observation is in right cluster"] },
                    { src: "Kahoot", cat: "L2", q: "Principal Components usually cannot be interpreted.", a: "True", opts: ["True", "False"] },

                    { src: "Kahoot", cat: "L3", q: "FALSE about linear reg?", a: "Beta0 is gradient", opts: ["y is target", "x is input", "Beta0 is intercept", "Beta0 is gradient"] },
                    { src: "Kahoot", cat: "L3", q: "FALSE about MLR/RÂ²?", a: "If RÂ² higher, model definitely better", opts: ["Ceteris paribus", "If RÂ² higher, model definitely better", "RÂ² increases with vars", "No constant input"] },
                    { src: "Kahoot", cat: "L3", q: "Positive coeff means y/xi correlated?", a: "False", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L3", q: "Coeff for vertical height diff (dummy)?", a: "Beta1", opts: ["Beta0", "Beta1", "Beta2", "y"] },
                    { src: "Kahoot", cat: "L3", q: "10 values need how many dummies?", a: "9", opts: ["8", "9", "10", "11"] },
                    { src: "Kahoot", cat: "L3", q: "FALSE about train/test?", a: "Testing set should be bigger", opts: ["Train known target", "Testing set should be bigger", "Test hidden target", "Test not for training"] },
                    { src: "Kahoot", cat: "L3", q: "Logistic Reg suitable for classifier?", a: "True", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L3", q: "Odds of coin head (70%)?", a: "7/3", opts: ["3/7", "1", "7/3", "0"] },
                    { src: "Kahoot", cat: "L3", q: "Sum equals 1?", a: "TPR + FNR", opts: ["TPR + FPR", "TNR + FNR", "TPR + FNR", "Precision + TPR"] },
                    { src: "Kahoot", cat: "L3", q: "Optimize Recall for?", a: "Earthquake prediction", opts: ["YouTube ad", "Earthquake prediction"] },

                    { src: "Kahoot", cat: "L4", q: "Low Bias High Variance?", a: "Complex model; overfitting", opts: ["Complex model; overfitting", "Complex; underfitting", "Simple; underfitting", "Simple; overfitting"] },
                    { src: "Kahoot", cat: "L4", q: "Min observations for 5 terms?", a: "50", opts: ["30", "40", "50", "60"] },
                    { src: "Kahoot", cat: "L4", q: "If alpha large, coeffs limited?", a: "True", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L4", q: "Regularization sparse coeffs?", a: "LASSO", opts: ["LASSO", "Ridge"] },
                    { src: "Kahoot", cat: "L4", q: "FALSE about train-val-test?", a: "Validation set can only be used once", opts: ["Test once", "Test diverse", "Validation set can only be used once for training", "Validation fine-tune"] },
                    { src: "Kahoot", cat: "L4", q: "Leave-one-out CV for small data?", a: "True", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L4", q: "Area unit increases (sqm->sqft). Implication?", a: "Value goes up; less penalty on coefficient", opts: ["Value down; less penalty", "Value up; more penalty", "Value down; more penalty", "Value goes up; less penalty on coefficient"] },
                    { src: "Kahoot", cat: "L4", q: "Big datasets prefer complex?", a: "True", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L4", q: "If y 90% True, model predicts False?", a: "False", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L4", q: "NOT purpose of regularization?", a: "Find perfect model for training", opts: ["Address overfitting", "Prevent complex", "Reduce coeff", "Find perfect model for training"] },

                    { src: "Kahoot", cat: "L5", q: "FALSE about decision trees?", a: "Deep trees less likely to overfit", opts: ["Feature selection", "Handle numeric/cat", "Deep trees less likely to overfit", "Split on impurity"] },
                    { src: "Kahoot", cat: "L5", q: "Correct interpretation of Gini?", a: "Measures randomness / impurity", opts: ["Nodes created", "Measures randomness / impurity", "Total error", "Leaves count"] },
                    { src: "Kahoot", cat: "L5", q: "TRUE about entropy?", a: "Equals 0 when node is pure", opts: ["Always negative", "Equals 0 when node is pure", "Increases when purer", "Unrelated to gain"] },
                    { src: "Kahoot", cat: "L5", q: "Technique to prevent overfitting in trees?", a: "Pruning", opts: ["Increasing depth", "Adding variables", "Pruning", "Increasing leaves"] },
                    { src: "Kahoot", cat: "L5", q: "FALSE about Random Forest?", a: "Uses boosting", opts: ["Uses bagging", "Reduces variance", "Uses boosting", "Multiple trees"] },
                    { src: "Kahoot", cat: "L5", q: "Feature bagging in RF?", a: "Using random subset of features", opts: ["All features", "Using random subset of features", "PCA", "Removing correlated"] },
                    { src: "Kahoot", cat: "L5", q: "TRUE for decision trees?", a: "Very interpretable", opts: ["Very interpretable", "Heavy preprocessing", "Only classification", "No missing values"] },
                    { src: "Kahoot", cat: "L5", q: "Tree grows too deep?", a: "Model overfits", opts: ["Underfits", "Generalizes", "Model overfits", "No change"] },

                    { src: "Kahoot", cat: "L7", q: "Activation function outputting 0 to 1?", a: "Sigmoid", opts: ["ReLU", "Sigmoid", "Tanh", "Linear"] },
                    { src: "Kahoot", cat: "L7", q: "TRUE about neural networks?", a: "Require activation for non-linearity", opts: ["Cannot model non-linear", "Require activation for non-linearity", "Only for images", "Always outperform"] },
                    { src: "Kahoot", cat: "L7", q: "Backpropagation used for?", a: "Updating weights", opts: ["Evaluation", "Updating weights", "Increasing data", "Missing values"] },
                    { src: "Kahoot", cat: "L7", q: "Disadvantage of neural networks?", a: "Require large datasets", opts: ["Interpretable", "Require large datasets", "Always converge", "No tuning"] },
                    { src: "Kahoot", cat: "L7", q: "Example of hyperparameter?", a: "Learning rate", opts: ["Weight", "Bias", "Learning rate", "Activation output"] },
                    { src: "Kahoot", cat: "L7", q: "Overfitting in ANN?", a: "Training loss Down, Test loss Up", opts: ["Train Down Test Down", "Training loss Down, Test loss Up", "Train Up Test Down", "Train Up Test Up"] },

                    { src: "Kahoot", cat: "L8", q: "TRUE about ensemble?", a: "Combine predictions from multiple models", opts: ["Always reduce variance", "Combine predictions from multiple models", "Always reduce bias", "Interpretability"] },
                    { src: "Kahoot", cat: "L8", q: "Which is boosting?", a: "XGBoost", opts: ["Random Forest", "XGBoost", "Bagging", "Feature selection"] },
                    { src: "Kahoot", cat: "L8", q: "Bagging models trained on?", a: "Random samples with replacement", opts: ["Identical data", "Random samples with replacement", "Without replacement", "Only misclassified"] },
                    { src: "Kahoot", cat: "L8", q: "Main idea of boosting?", a: "Reduce bias by improving weak learners", opts: ["Deep trees", "Reduce bias by improving weak learners", "Parallel models", "Remove correlated"] },
                    { src: "Kahoot", cat: "L8", q: "NOT an ensemble?", a: "Normalization", opts: ["Stacking", "Boosting", "Bagging", "Normalization"] },
                    { src: "Kahoot", cat: "L8", q: "TRUE about XGBoost?", a: "Uses gradient boosting", opts: ["Pruning main", "Uses gradient boosting", "Outperforms RF", "No missing values"] },

                    { src: "Kahoot", cat: "L9", q: "Why MAB better for YouTube?", a: "MAB adaptively displays", opts: ["Diverse", "MAB adaptively displays", "Efficient"] },
                    { src: "Kahoot", cat: "L9", q: "Random Pull favors best arm?", a: "False", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L9", q: "Fixed epsilon means exploration goes down?", a: "False", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L9", q: "As n -> infinity, posterior closer to truth?", a: "True", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L9", q: "Likelihood of choosing Arm 2 (Green) vs Arm 3 (Red)?", a: "Very likely", opts: ["Unlikely", "Very likely", "Unlikely < Arm 1", "Equal"] },
                    { src: "Kahoot", cat: "L9", q: "Exploration maximizes immediate rewards?", a: "False", opts: ["True", "False"] },

                    { src: "Kahoot", cat: "L10", q: "Semantic vs Instance Segmentation same?", a: "False", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L10", q: "Why CNN superior?", a: "Capture local spatial patterns", opts: ["Capture local spatial patterns", "Less computation", "Time series", "Interpretability"] },
                    { src: "Kahoot", cat: "L10", q: "Purpose of convolution?", a: "Feature extraction", opts: ["Non-linear", "Regularization", "Feature extraction", "Dim reduction"] },
                    { src: "Kahoot", cat: "L10", q: "Activation adds non-linearity?", a: "True", opts: ["True", "False"] },
                    { src: "Kahoot", cat: "L10", q: "Purpose of pooling?", a: "Dimension reduction", opts: ["Feature extraction", "Non-linear", "Dimension reduction", "Regularization"] }
                ],
                
                // Quiz
                quizState: 'start',
                quizQuestions: [],
                currentQuestionIndex: 0,
                score: 0,
                hasAnswered: false,
                isCorrect: false,
                currentQuizQuestion: {}
            }
        },
        computed: {
            filteredQuestions() {
                if (this.bankFilter === 'All') return this.allQuestions;
                if (this.bankFilter === 'Practice') return this.allQuestions.filter(q => q.source === 'Practice');
                return this.allQuestions.filter(q => q.cat.startsWith(this.bankFilter));
            }
        },
        watch: {
            mistakes: {
                handler(val) { localStorage.setItem('infs_mistakes_v4', JSON.stringify(val)); },
                deep: true
            }
        },
        mounted() {
            // Pre-process questions to add state
            this.allQuestions.forEach(q => {
                q.userSelected = null;
            });
        },
        methods: {
            resetApp() {
                if(confirm("Reset all mistakes?")) {
                    localStorage.removeItem('infs_mistakes_v4');
                    window.location.reload();
                }
            },
            checkBankAnswer(q, opt) {
                q.userSelected = opt;
                if(opt !== q.answer) {
                    const m = JSON.parse(JSON.stringify(q));
                    m.userSelected = null;
                    if(!this.mistakes.find(x => x.q === m.q)) this.mistakes.push(m);
                }
            },
            getBankClass(q, opt) {
                if (!q.userSelected) return 'border-gray-200 hover:bg-blue-50';
                if (opt === q.answer) return 'bg-green-100 border-green-500 text-green-700 font-bold';
                if (opt === q.userSelected) return 'bg-red-100 border-red-500 text-red-700';
                return 'opacity-50';
            },
            solveMistake(idx, opt, ans) {
                if(opt === ans) {
                    alert("Correct! Removed from mistakes.");
                    this.mistakes.splice(idx, 1);
                } else {
                    alert("Wrong again!");
                }
            },
            startQuiz() {
                this.quizQuestions = this.allQuestions.sort(() => 0.5 - Math.random()).slice(0, 10);
                this.currentQuestionIndex = 0;
                this.score = 0;
                this.hasAnswered = false;
                this.currentQuizQuestion = this.quizQuestions[0];
                this.quizState = 'playing';
            },
            checkQuizAnswer(opt) {
                this.hasAnswered = true;
                if (opt === this.currentQuizQuestion.answer) {
                    this.score++;
                    this.isCorrect = true;
                } else {
                    this.isCorrect = false;
                    const m = JSON.parse(JSON.stringify(this.currentQuizQuestion));
                    m.userSelected = null;
                    if(!this.mistakes.find(x => x.q === m.q)) this.mistakes.push(m);
                }
            },
            getQuizClass(opt) {
                if (!this.hasAnswered) return 'border-gray-200 hover:bg-blue-50';
                if (opt === this.currentQuizQuestion.answer) return 'bg-green-100 border-green-500 font-bold';
                return 'opacity-50';
            },
            nextQuestion() {
                if (this.currentQuestionIndex < 9) {
                    this.currentQuestionIndex++;
                    this.currentQuizQuestion = this.quizQuestions[this.currentQuestionIndex];
                    this.hasAnswered = false;
                } else {
                    this.quizState = 'result';
                }
            }
        }
    }).mount('#app');
</script>

</body>
</html>
